# Fiji Worm Counter

Automated counting of fluorescent worms from RGB TIFF images generated by [WormScan](https://www.wormbook.org/). Replaces manual counting in Fiji/ImageJ.

The WormScan scanner captures two images of each plate (at the beginning and end of the scan). One appears in the green channel and one in the red channel â€” both show the same worms. This tool counts worms in each channel separately and averages the two for a more accurate result.

## Usage

```bash
pip install -r requirements.txt

# Place your .tif files in the scan/ directory, then:
python worm_counter.py
```

Results are written to `output.txt` and annotated debug images are saved to `output/`.

### Options

| Flag | Description | Default |
|------|-------------|---------|
| `--min-size` | Minimum contour area to count as a worm | 50 |
| `--max-size` | Maximum contour area to count as a worm | 5000 |
| `--scan-dir` | Input directory containing `.tif` images | `scan/` |
| `--output-dir` | Output directory for debug images | `output/` |

## How It Works

1. Detects the circular petri plate region using Hough circle transform
2. Applies Otsu thresholding to each color channel to find bright worms
3. Filters detected contours by area (configurable via `--min-size` / `--max-size`)
4. Averages the green and red channel counts for each plate
5. Produces annotated images showing detected worm outlines for verification

## Requirements

- Python 3.8+
- opencv-python
- numpy
